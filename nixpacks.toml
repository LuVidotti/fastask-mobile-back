# Nixpacks Configuration for Fastask Backend

[phases.setup]
nixPkgs = ["nodejs_20"]

[phases.install]
cmds = ["npm ci"]

[phases.build]
cmds = [
    "npm run clean",
    "npx tsc",
    "npx prisma generate",
    "cp -r src/generated dist/generated || mkdir -p dist/generated && cp -r src/generated/* dist/generated/"
]

[start]
cmd = "node dist/server.js"

[variables]
NODE_ENV = "production"
